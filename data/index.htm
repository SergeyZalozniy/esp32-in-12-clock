<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="description" content="">
	<meta name="author" content="">
	<title>Nixie Clock Settings</title>

	<link rel="stylesheet" href="css/bootstrap.min.css">
	<link rel="stylesheet" href="css/bootstrap-switch.css">
	<link rel="stylesheet" href="css/template.css">
	<link rel="stylesheet" href="css/slider1.css">
	<link rel="stylesheet" href="css/slider2.css">

<body>
	<div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
		<div class="container">

			<div class="navbar-header">
				<button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
					<span class="sr-only">Toggle navigation</span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
				</button>
				<a class="navbar-brand" href="#">Nixie Clock v1.0</a>
			</div>

			<div class="collapse navbar-collapse">
				<ul class="nav navbar-nav">
					<li class="active"><a href="/">Nixie Clock Settings</a></li>
					<li><a href="settings.htm">Wi-Fi Settings</a></li>
				</ul>
			</div>

		</div>
	</div>
	<div class="container">
		<div class="starter-template">
			<form method="POST" enctype="multipart/form-data" id="upload_form">

				<div class="panel panel-default">
					<div class="panel-heading">
						<h5>Fimvare / SPIFFS  update</h5>
					</div>
					<div class="panel-body">
						<div class="form-group form-group-lg">
							<input class="form-control" type="file" name="update">
						</div>

						<div class="progress" style="display: none;">
							<div id="prg" class="progress-bar" role="progressbar" aria-valuemin="0" aria-valuemax="100">
								Progress: <span>0%</span>
							</div>
						</div>

						<div class="form-check" style="display: inline; margin-right: 15px;">
							<input class="form-check-input" type="radio" name="upload-type" id="upload-type1" value="0" checked>
							<label class="form-check-label" for="upload-type1">
								Fimware
							</label>
						</div>
						<div class="form-check" style="display: inline;">
							<input class="form-check-input" type="radio" name="upload-type" id="upload-type2" value="100">
							<label class="form-check-label" for="upload-type2">
								SPIFFS
							</label>
						</div>

						<div class="form-group form-group-lg" style="padding-top: 15px; margin: 0;">
							<input class="btn btn-primary" type="submit" value="Update">
						</div>
					</div>
				</div>
			</form>

<!-- 
			<div class="panel panel-default">
				<div class="panel-heading">
					<h5>Выберите эффект смены цифр</h5>
				</div>
				<div class="panel-body">
					<div class="form-group form-group-lg">
						<select class="form-control" id="effect" name="effect">
							<option value="0">Конфетти</option>
							<option value="1">Огонь</option>
							<option value="2">Радуга верт.</option>
							<option value="3">Радуга гориз.</option>
							<option value="4">Смена цвета</option>
							<option value="5">Безумие 3D</option>
							<option value="6">Облака 3D</option>
							<option value="7">Лава 3D</option>
							<option value="8">Плазма 3D</option>
							<option value="9">Радуга 3D</option>
							<option value="10">Павлин 3D</option>
							<option value="11">Зебра 3D</option>
							<option value="12">Лес 3D</option>
							<option value="13">Океан 3D</option>
							<option value="14">Моноцвет</option>
							<option value="15">Снег</option>
							<option value="16">Матрица</option>
							<option value="17">Светляки</option>
						</select>
					</div>
				</div>
			</div>

			<div class="panel panel-default">
				<div class="panel-heading">
					<h4>Яркость</h4>
				</div>
				<div class="panel-body">
					<input type="text" id="volume" name="volume" value="" />
				</div>
			</div>

			<div class="panel panel-default">
				<div class="panel-heading">
					<h4>Скорость</h4>
				</div>
				<div class="panel-body">
					<input type="text" id="speeed" name="speeed" value="" />
				</div>
			</div>

			<div class="panel panel-default">
				<div class="panel-heading">
					<h4>Масштаб</h4>
				</div>
				<div class="panel-body">
					<input type="text" id="scale" name="scale" value="" />
				</div>
			</div>

			<div class="panel panel-default">
				<div class="panel-heading">
					<h5 id="h5_timer">Выберите время работи до выключения</h5>
				</div>
				<div class="panel-body">
					<div class="form-group form-group-lg">
						<select class="form-control" id="timer" name="timer">
							<option value="0">Работать всегда</option>
							<option value="15">15 минут</option>
							<option value="30">30 минут</option>
							<option value="45">45 минут.</option>
							<option value="60">1 часа</option>
							<option value="120">2 часа</option>
							<option value="240">4 часа</option>
						</select>
					</div>
				</div>
			</div> -->

		</div>
	</div>

	<script src="js/jquery.min.js"></script>
	<script src="js/bootstrap.min.js"></script>
	<script src="js/highlight.js"></script>
	<script src="js/slider.js"></script>
	<script src="js/bootstrap-switch.js"></script>
	<script src="js/main.js"></script>

	<script>

		// $($("#prg")[0]).width(Math.round(.33 * 100) + "%");
		// $($("#prg span")[0]).html(Math.round(.33 * 100) + "%");

		$("form").submit(function (e) {
			e.preventDefault();
			var form = $("#upload_form")[0];
			var uploadTypeValue = $('input[name=upload-type]:checked').val();
			var data = new FormData(form);

			$(".progress").css("display","block")

			$.ajax({
				url: "/update?type=" + uploadTypeValue,
				type: "POST",
				data: data,
				contentType: false,
				processData: false,
				xhr: function () {
					var xhr = new window.XMLHttpRequest();
					xhr.upload.addEventListener("progress", function (evt) {
						if (evt.lengthComputable) {
							var per = evt.loaded / evt.total;
							$($("#prg")[0]).width(Math.round(per * 100) + "%");
							$($("#prg span")[0]).html(Math.round(per * 100) + "%");
						}
					}, false);
					return xhr;
				},
				success: function (d, s) {
					alert("Success!");
					$(".progress").css("display","none");
				},
				error: function (a, b, c) {
					alert("Failed!");
					$(".progress").css("display","none");
				}
			});
		});
	</script>
</body>

</html>